{% extends "base.html" %}

{% block content %}
{% set meta_box %}
{% if page.meta %}
<div class="wiki-meta">
    {% for key, value in page.meta.items() if key not in ["title", "hide", "template", "aliases"] %}
    <div class="wiki-meta__row">
            <span class="wiki-meta__key">
              {{ key | replace("_", " ") | replace("tags", "tagy") | capitalize }}
            </span>
        <span class="wiki-meta__value">
              {% if value is iterable and value is not string %}
                {{ value | join(", ") }}
              {% else %}
                {{ value }}
              {% endif %}
            </span>
    </div>
    {% endfor %}
</div>
{% endif %}
{% endset %}

{# Render the original content (with title) into a string #}
{% set original = super() %}

{# Inject the meta box right after the first </h1> #}
{% if '</h1>' in original %}
{{ original | replace('</h1>', '</h1>' ~ meta_box, 1) | safe }}
{% else %}
{{ meta_box }}
{{ original | safe }}
{% endif %}
{% endblock %}
